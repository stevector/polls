## Customize dependencies
dependencies:
  pre:
#    - npm install coffeescript # install from a different package manager

  override:
    # From https://www.digitalocean.com/community/tutorials/how-to-set-up-r-on-ubuntu-14-04
    - sudo sh -c 'echo "deb http://cran.rstudio.com/bin/linux/ubuntu trusty/" >> /etc/apt/sources.list'
    - gpg --keyserver keyserver.ubuntu.com --recv-key E084DAB9
    - gpg -a --export E084DAB9 | sudo apt-key add -
    - sudo apt-get update
    - sudo apt-get -y install r-base
    - sudo apt-get install pandoc
    # Install all the packages referenced at the top of runmodel.R
    - sudo su - -c "R -e \"install.packages('rstan', repos = 'http://cran.rstudio.com/')\""
    - sudo su - -c "R -e \"install.packages('dplyr', repos = 'http://cran.rstudio.com/')\""
    - sudo su - -c "R -e \"install.packages('tidyr', repos = 'http://cran.rstudio.com/')\""
    - sudo su - -c "R -e \"install.packages('purrr', repos = 'http://cran.rstudio.com/')\""    
    - sudo su - -c "R -e \"install.packages('stringr', repos = 'http://cran.rstudio.com/')\""
    - sudo su - -c "R -e \"install.packages('lubridate', repos = 'http://cran.rstudio.com/')\""
    - sudo su - -c "R -e \"install.packages('curl', repos = 'http://cran.rstudio.com/')\""    
    - sudo su - -c "R -e \"install.packages('shinystan', repos = 'http://cran.rstudio.com/')\""
    - sudo su - -c "R -e \"install.packages('rmarkdown', repos = 'http://cran.rstudio.com/')\""




  # we automatically cache and restore many dependencies between
  # builds. If you need to, you can add custom paths to cache:
  cache_directories:
    - /usr/share/R
    - /usr/lib/R
    - /usr/local/lib/R

## Customize test commands
test:
  override:
    - mkdir -p ~/GitHub/polls
    - Rscript runmodel.R
